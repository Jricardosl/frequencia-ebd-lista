<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Frequência EBD</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="css/style.css">
  <link rel="icon" href="images/LOGO NAZARENO.jpeg" type="image/jpeg">
  <link rel="icon" href="images/icon-192.png" type="image/png">
  <meta name="theme-color" content="#003366" />
</head>
<body>
  <header>
    <img src="images/LOGO NAZARENO.jpeg" alt="Logo Igreja do Nazareno" id="logo">
    <h1>Frequência da Escola Bíblica Dominical</h1>
  </header>

  <div class="form-container">
    <label for="ano">Ano:</label>
    <select id="ano" onchange="carregarAlunos()"></select>

    <label for="mes">Mês:</label>
    <select id="mes" onchange="carregarAlunos()">
      <option value="">Selecione</option>
      <option value="0">Janeiro</option>
      <option value="1">Fevereiro</option>
      <option value="2">Março</option>
      <option value="3">Abril</option>
      <option value="4">Maio</option>
      <option value="5">Junho</option>
      <option value="6">Julho</option>
      <option value="7">Agosto</option>
      <option value="8">Setembro</option>
      <option value="9">Outubro</option>
      <option value="10">Novembro</option>
      <option value="11">Dezembro</option>
    </select>

    <label for="turma">Turma:</label>
    <select id="turma" onchange="carregarAlunos()">
      <option value="">Selecione</option>
      <option value="criancas">Crianças</option>
      <option value="adolescentes">Adolescentes</option>
      <option value="jovens">Jovens</option>
      <option value="adulto">Adulto</option>
      <option value="terceira_idade">Terceira Idade</option>
      <option value="discipulado">Discipulado</option>
    </select>
  </div>

  <table id="tabela">
    <thead>
      <tr id="cabecalho">
        <!-- Cabeçalho gerado dinamicamente -->
      </tr>
    </thead>
    <tbody id="listaAlunos">
      <!-- Linhas dos alunos geradas dinamicamente -->
    </tbody>
  </table>

  <div class="buttons">
    <button onclick="salvarFrequencia()">Salvar como Excel</button>
    <button onclick="gerarPDF()">Salvar como PDF</button>
  </div>

  <div id="mensagem" class="oculto">Frequência enviada com sucesso!</div>

  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script src="js/alunos.js"></script>
  <script src="js/script.js"></script>
  <script src="js/pwa.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const anoSelect = document.getElementById("ano");
      const currentYear = new Date().getFullYear();
      for (let i = currentYear - 2; i <= currentYear + 1; i++) {
        const option = document.createElement("option");
        option.value = i;
        option.text = i;
        if (i === currentYear) option.selected = true;
        anoSelect.appendChild(option);
      }
    });
  </script>
  
</body>
</html>

<div class="form-add">
  <h3>Adicionar novo aluno</h3>
  <input type="text" id="novoAlunoNome" placeholder="Nome do aluno">
  <button onclick="adicionarAluno()">Adicionar</button>
</div>
